@using Model;
@using Data;
@using Services;
@using Microsoft.EntityFrameworkCore;
@inject ClientStateService ClientState;
@inject IDbContextFactory<DatabaseContext> DatabaseFactory;


<div class="text-center bg-blue-100">
    <input class="border-4 w-1/3 rounded m-6 p-6 h-8
               border-blue-300" @bind-value="SearchText"
    @bind-value:event="oninput" placeholder="Search by title" />
</div>

    <div class="p-2 grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3">
        @foreach (Course course in FilteredCourses)
        {
            <p>@course.Name</p>
        }
    </div>

@code {
    public string SearchText = "";
    List<Course> FilteredCourses => db.Courses.Where(c=> c.Name.ToLower().Contains(SearchText.ToLower())).ToList();

    private DatabaseContext? db { get; set; }
    protected async override Task OnInitializedAsync()
    {
        db ??= DatabaseFactory.CreateDbContext();
    }
}
